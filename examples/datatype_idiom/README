Contributed by Johnicholas Hines, along with some disclaimers about
the code quality.
